<script setup lang="ts">
import HeaderSearch from './HeaderSearch.vue'
import { formatDateSafe } from '~/utils/date'

// Check if development mode
const isDev = process.env.NODE_ENV === 'development'

// Format time function
function formatTimeSafe(dateStr?: string): string {
  if (!dateStr) {
    // Generate random time for demo
    const hour = Math.floor(Math.random() * 24).toString().padStart(2, '0')
    const minute = Math.floor(Math.random() * 60).toString().padStart(2, '0')
    return `${hour}.${minute}`
  }
  try {
    const date = new Date(dateStr)
    if (isNaN(date.getTime())) {
      // Generate random time for demo
      const hour = Math.floor(Math.random() * 24).toString().padStart(2, '0')
      const minute = Math.floor(Math.random() * 60).toString().padStart(2, '0')
      return `${hour}.${minute}`
    }
    return date.toLocaleTimeString('id-ID', { 
      hour: '2-digit', 
      minute: '2-digit',
      hour12: false 
    }).replace(':', '.')
  } catch {
    // Generate random time for demo
    const hour = Math.floor(Math.random() * 24).toString().padStart(2, '0')
    const minute = Math.floor(Math.random() * 60).toString().padStart(2, '0')
    return `${hour}.${minute}`
  }
}

type BlogApiPost = {
  id: number;
  slug: string;
  title: string;
  date: string;
  image: string;
};

type BlogApiResponse = {
  posts: BlogApiPost[];
  totalPages: number;
  currentPage: number;
};


interface BlogResponse {
  data: [
    {
      id: number;
      slug: string;
      title: string;
      publish_at: string;
      featured_image: string;
    }
  ];
  meta: {
    current_page: number;
    last_page: number;
    total_posts: number;
    links: [
      {
        active: boolean;
        label: string;
        url: string | null;
      }
    ]
  };
}

function buildAiHeroUrl(titleText?: string, slugText?: string) {
  const cleanTitle = (titleText || '').replace(/<[^>]*>/g, '').trim();
  const basePrompt = cleanTitle
    ? `${cleanTitle}, modern 3D illustration, gradient lighting, PAYTECH payments, isometric, glassmorphism, highly detailed, cinematic, trending on dribbble`
    : `modern 3D illustration, gradient lighting, PAYTECH payments, isometric, glassmorphism, highly detailed, cinematic, trending on dribbble`;
  const encoded = encodeURIComponent(basePrompt);
  const seed = encodeURIComponent(String(slugText || cleanTitle || 'blog'));
  return `https://image.pollinations.ai/prompt/${encoded}?seed=${seed}&width=1200&height=630&nologo=true&enhance=true`;
}

// Dummy images pool for reliable fallback - Updated to include all 100 images
// Blog images pool - using dummy folder images that are known to work
const BLOG_IMAGES = [
  'dummy-1.jpg',
  'dummy-2.jpg', 
  'dummy-3.jpg',
  'dummy-4.jpg',
  'dummy-5.jpg',
  'dummy-6.jpg',
  'dummy-7.jpg',
  'dummy-8.jpg'
]

// Simple image URLs that are guaranteed to work
const SIMPLE_IMAGES = [
  'https://picsum.photos/400/300?random=1',
  'https://picsum.photos/400/300?random=2',
  'https://picsum.photos/400/300?random=3',
  'https://picsum.photos/400/300?random=4',
  'https://picsum.photos/400/300?random=5',
  'https://picsum.photos/400/300?random=6',
  'https://picsum.photos/400/300?random=7',
  'https://picsum.photos/400/300?random=8'
]

// Test blog images availability
if (import.meta.client) {
  // console.log('BLOG_IMAGES array:', BLOG_IMAGES)
}

// Test function to verify blog images
function testBlogImages() {
  // console.log('Testing blog images:', BLOG_IMAGES.slice(0, 3))
}

function isValidImageUrl(url?: string) {
  if (!url || typeof url !== 'string') return false
  try {
    const base = import.meta.client ? window.location.origin : 'http://localhost'
    const u = new URL(url, base)
    const isHttp = u.protocol === 'http:' || u.protocol === 'https:'
    const isDataImg = url.startsWith('data:image')
    return isHttp || isDataImg
  } catch {
    return false
  }
}

function normalizeImageUrlClient(img?: string): string {
  const s = String(img || '').trim()
  if (!s) return ''
  if (s.startsWith('data:image')) return s
  if (s.startsWith('http://') || s.startsWith('https://')) return s
  if (s.startsWith('//')) return `https:${s}`
  if (s.startsWith('/')) return s
  return ''
}

// Hash function for deterministic dummy image selection
function hashString(input: string): number {
  let h = 2166136261 >>> 0
  for (let i = 0; i < input.length; i++) { 
    h ^= input.charCodeAt(i); 
    h = Math.imul(h, 16777619) 
  }
  return h >>> 0
}

function getSafeImage(candidate?: string, titleText?: string, slugText?: string) {
  // Normalize common patterns that could break on the client
  const normalized = normalizeImageUrlClient(candidate)
  
  // If it's fallback-news.svg, replace with dummy image for consistency
  if (normalized === '/images/fallback-news.svg') {
    const seed = slugText || titleText || 'default'
    const idx = hashString(seed) % BLOG_IMAGES.length
    return `/images/dummy/${BLOG_IMAGES[idx] || BLOG_IMAGES[0]}`
  }
  
  // Prefer provided image if it's a valid URL
  if (isValidImageUrl(normalized)) {
    return String(normalized || '')
  }
  
  // Use deterministic dummy image based on slug or title
  const seed = slugText || titleText || 'default'
  const idx = hashString(seed) % BLOG_IMAGES.length
  return `/images/dummy/${BLOG_IMAGES[idx] || BLOG_IMAGES[0]}`
}

// Choose the best image for card rendering with priority:
// 1) featured_image or image from API if valid (and not the local fallback)
// 2) Dummy image based on slug (deterministic)
// 3) First dummy image as final fallback
function getCardImage(b: any): string {
  // Use simple images that are guaranteed to work
  const slug = String(b?.slug || 'default')
  const idx = hashString(slug) % SIMPLE_IMAGES.length
  const selectedImage = SIMPLE_IMAGES[idx] || SIMPLE_IMAGES[0]
  
  // Return external image URL that's guaranteed to work
  return selectedImage as string
}

function onCardImgError(e: Event) {
  const img = e.target as HTMLImageElement | null
  if (!img) return
  
  const cardId = img.getAttribute('data-card-id') || 'default'
  
  // Hide the image and show fallback placeholder
  img.style.display = 'none'
  
  // Find and show the fallback placeholder
  const fallbackPlaceholder = img.parentElement?.querySelector('.fallback-placeholder') as HTMLElement
  if (fallbackPlaceholder) {
    fallbackPlaceholder.style.display = 'flex'
  }
}

function onCardImgLoad(e: Event) {
  const img = e.target as HTMLImageElement | null
  if (!img) return
  
  const cardId = img.getAttribute('data-card-id') || 'default'
  
  // Hide fallback placeholder when image loads successfully
  const fallbackPlaceholder = img.parentElement?.querySelector('.fallback-placeholder') as HTMLElement
  if (fallbackPlaceholder) {
    fallbackPlaceholder.style.display = 'none'
  }
}

// Loading functions - Optimized for faster performance
let loadingInterval: NodeJS.Timeout | null = null

function startLoading(message: string = 'Memuat data...') {
  // Clear any existing interval
  if (loadingInterval) {
    clearInterval(loadingInterval)
  }
  
  isLoading.value = true
  loadingProgress.value = 0
  loadingMessage.value = message
  loadingStartTime.value = Date.now()
  
  // Faster progress simulation
  loadingInterval = setInterval(() => {
    if (loadingProgress.value < 85) {
      loadingProgress.value += Math.random() * 15 + 5 // Faster progress
    }
  }, 50) // Faster interval
  
  return loadingInterval
}

function stopLoading() {
  // Clear the interval first
  if (loadingInterval) {
    clearInterval(loadingInterval)
    loadingInterval = null
  }
  
  isLoading.value = false
  loadingProgress.value = 100
  const elapsed = ((Date.now() - loadingStartTime.value) / 1000).toFixed(1)
  loadingMessage.value = `Selesai dalam ${elapsed} detik`
  
  // Faster cleanup
  setTimeout(() => {
    loadingProgress.value = 0
    loadingMessage.value = ''
  }, 500) // Shorter delay
}

// Show title popup
function showTitlePopup(title: string) {
  showPopup.value = title
  // Auto close after 5 seconds
  setTimeout(() => {
    showPopup.value = null
  }, 5000)
}

// Close popup when clicking outside
function closePopupOnOutsideClick(event: Event) {
  if (showPopup.value && !(event.target as Element).closest('.title-popup')) {
    showPopup.value = null
  }
}

// Navigate to article page
function navigateToArticle(blog: any) {
  console.log('Navigating to article:', blog)
  
  // Check if blog has slug, if not try to generate one from title
  let slug = blog?.slug
  if (!slug && blog?.title) {
    // Generate slug from title as fallback
    slug = blog.title
      .toLowerCase()
      .replace(/[^a-z0-9\s-]/g, '') // Remove special characters
      .replace(/\s+/g, '-') // Replace spaces with hyphens
      .replace(/-+/g, '-') // Replace multiple hyphens with single
      .trim()
  }
  
  if (!slug) {
    console.warn('Blog slug not found and cannot generate from title:', blog)
    return
  }
  
  try {
    console.log('Navigating to:', `/blog/${slug}`)
    // Use router.push for navigation
    router.push(`/blog/${slug}`)
  } catch (error) {
    console.error('Navigation error:', error)
    // Fallback to window.location if router fails
    window.location.href = `/blog/${slug}`
  }
}


const props = defineProps<{ mode?: 'home' | 'list'; limit?: number }>()
const isHome = computed(() => props.mode === 'home')
const homeLimit = computed(() => Math.min(Math.max(Number(props.limit ?? 8), 1), 24))

// Auto slider state
const currentSlide = ref(0)
const slideInterval = ref<NodeJS.Timeout | null>(null)
const isAutoSliding = ref(true)

// Image loading state - per card basis (simplified approach)
const imageLoadedStates = ref<Record<string, boolean>>({})

// Loading states
const isLoading = ref(false)
const loadingProgress = ref(0)
const loadingMessage = ref('')
const loadingStartTime = ref(0)

// Title popup state
const showPopup = ref<string | null>(null)

// Slider computed properties
const totalSlides = computed(() => {
  const slides = Math.ceil((blogs.value?.data?.length || 0) / 8)
  // console.log('ðŸ“Š Total Slides:', slides, 'Data Length:', blogs.value?.data?.length)
  return slides
})
const currentSlidePosts = computed(() => {
  if (!blogs.value?.data) return []
  const start = currentSlide.value * 8
  const end = start + 8
  return blogs.value.data.slice(start, end)
})

const route = useRoute();
const router = useRouter();
const params = ref<number>(Number((route.query.page as string) || 1) || 1);

// Search state synced with route (?q=)
const searchQuery = ref<string>(typeof route.query.q === 'string' ? (route.query.q as string) : '');
const searchModel = ref<string>(searchQuery.value);
const showSearchDropdown = ref(false);
const searchHistory = ref<string[]>([]);
const searchSuggestions = ref<string[]>([]);
const popularSearches = ref([
  'PayPal', 'Netflix', 'Pembayaran Online', 'Digital Banking', 
  'Keamanan Transaksi', 'PAYTECH', 'E-commerce', 'Cryptocurrency',
  'Gopay', 'Dana', 'OVO', 'ShopeePay', 'LinkAja', 'BCA', 'Mandiri',
  'Bitcoin', 'Ethereum', 'Crypto', 'Blockchain', 'Trading', 'Investasi',
  'Domain', 'Hosting', 'Website', 'SEO', 'Marketing', 'Bisnis Online'
]);

// Title popup state - removed as cards are now fully clickable

// View options state
const viewLimit = ref<number>(Number(route.query.limit) || 8);
const viewOptions = [8, 24, 50, 100, 0]; // 0 means all
const viewLabels = {
  8: '8 Artikel',
  24: '24 ke bawah',
  50: '50 Artikel',
  100: '100 Artikel',
  0: 'Semua Artikel'
};

const onSubmitSearch = async () => {
  try {
    const q = (searchModel.value || '').trim();
    const qParams: Record<string, any> = { ...route.query };
    if (q) {
      qParams.q = q;
    } else {
      delete qParams.q;
    }
    // Always reset page when applying search
    delete qParams.page;
    await router.replace({ query: qParams });
    // route watchers will update params and refresh
  } catch {}
};

// Function to change view limit
const changeViewLimit = async (limit: number) => {
  try {
    const loadingInterval = startLoading(`Mengubah tampilan ke ${limit === 0 ? 'semua' : limit} artikel...`);
    
    viewLimit.value = limit;
    const qParams: Record<string, any> = { ...route.query };
    
    if (limit === 8) {
      delete qParams.limit; // Default limit
      delete qParams.showAll; // Remove showAll mode
    } else if (limit === 0) {
      qParams.showAll = 'true'; // Show all mode
      delete qParams.limit;
    } else {
      qParams.limit = limit.toString();
      delete qParams.showAll; // Remove showAll mode
    }
    
    // Reset to page 1 when changing limit
    qParams.page = '1';
    params.value = 1;
    
    await router.replace({ query: qParams });
    await refresh();
    
    clearInterval(loadingInterval);
    stopLoading();
  } catch (error) {
    console.warn('Failed to change view limit:', error);
    stopLoading();
  }
};

watch(searchQuery, (val: string) => { searchModel.value = val; });

// Search functionality
const onSearchInput = () => {
  showSearchDropdown.value = true;
  if (searchModel.value.length >= 1) {
    // Generate suggestions based on input
    searchSuggestions.value = popularSearches.value.filter((term: string) => 
      term.toLowerCase().includes(searchModel.value.toLowerCase())
    );
  } else {
    searchSuggestions.value = [];
  }
};

const performSearch = async () => {
  if (!searchModel.value.trim()) return;
  
  const loadingInterval = startLoading('Mencari artikel...');
  
  try {
    // Add to search history
    if (!searchHistory.value.includes(searchModel.value)) {
      searchHistory.value.unshift(searchModel.value);
      if (searchHistory.value.length > 10) {
        searchHistory.value = searchHistory.value.slice(0, 10);
      }
    }
    
    // Update search query and trigger refresh
    searchQuery.value = searchModel.value;
    await router.replace({ 
      query: { ...route.query, q: searchModel.value, page: '1' } 
    });
    params.value = 1;
    await refresh();
    
    showSearchDropdown.value = false;
  } catch (error) {
    console.error('Search error:', error);
  } finally {
    clearInterval(loadingInterval);
    stopLoading();
  }
};

// Close search dropdown when clicking outside
const closeSearchDropdown = () => {
  showSearchDropdown.value = false;
};

// Add click outside listener
onMounted(() => {
  if (import.meta.client) {
    document.addEventListener('click', (event) => {
      const searchContainer = document.querySelector('.search-container');
      if (searchContainer && !searchContainer.contains(event.target as Node)) {
        showSearchDropdown.value = false;
      }
    });
  }
});

// Function to get all available blog posts from database
const getAllBlogPosts = async () => {
  try {
    const response: any = await $fetch('/api/blog', { 
      params: { limit: 1000, page: 1 },
      timeout: 10000 
    });
    return response?.data || response?.posts || [];
  } catch (error) {
    console.warn('Failed to get all blog posts:', error);
    return [];
  }
};

// Function to search in all blog posts
const searchAllBlogs = async (searchTerm: string) => {
  try {
    const response: any = await $fetch('/api/blog/search', { 
      params: { q: searchTerm, limit: 1000, page: 1 },
      timeout: 10000 
    });
    return response?.posts || response?.data || [];
  } catch (error) {
    console.warn('Failed to search all blogs:', error);
    return [];
  }
};

// Title popup functions - removed as cards are now fully clickable

// Computed properties for view management
const isShowAllMode = computed(() => viewLimit.value === 0);
const currentViewLabel = computed(() => viewLabels[viewLimit.value as keyof typeof viewLabels] || '8 Artikel');

const { data: blogs, status: blogStatus, refresh } = useAsyncData<BlogResponse>(
  () => `blogs:${params.value}:${searchQuery.value}:${viewLimit.value}`,
  async () => {
    const loadingInterval = startLoading('Memuat artikel blog...')
    
    try {
      const q = (searchQuery.value || '').trim();
      const limit = viewLimit.value === 0 ? 1000 : viewLimit.value; // 0 means all, use 1000 as max
      
      // Decide endpoint based on context
      let endpoint = '/api/blog'
      let reqParams: any = { page: params.value, limit }
      if (q) {
        endpoint = '/api/blog/search'
        // For search, use larger limit to get more results
        reqParams = { page: params.value, q, limit: Math.max(limit, 50) }
      } else if (isHome.value) {
        // Use paginated endpoint for homepage so pagination is available
        endpoint = '/api/blog'
        reqParams = { page: params.value, limit: 8 }
      } else {
        // For blog page (/blog), use default pagination with 8 posts per page
        // This ensures we get proper pagination (8 x 22 pages = 176 posts)
        endpoint = '/api/blog'
        reqParams = { page: params.value, limit: limit || 8 }
      }
      
      // Add timeout and retry for better performance
      console.log('Fetching from endpoint:', endpoint, 'with params:', reqParams)
      const res: any = await $fetch(endpoint, { 
        params: reqParams,
        timeout: 10000, // Increased timeout for better reliability
        retry: 1 // Allow one retry
      });
      
      console.log('API Response:', res)

      // Map response for both array (latest) and paginated object (index/search)
      const postsArr = Array.isArray(res) ? res : (res?.posts || res?.data || [])
      const pagination = res?.pagination || {}
      
      console.log('Posts array:', postsArr)
      console.log('Pagination:', pagination)
      
      // Ensure proper sorting by date (newest first) - additional client-side sorting
      postsArr.sort((a: any, b: any) => {
        const dateA = new Date(a?.date || a?.publish_at || 0).getTime()
        const dateB = new Date(b?.date || b?.publish_at || 0).getTime()
        return dateB - dateA // Newest first
      })
      
      // If no posts found and we're on a high page number, redirect to page 1
      if (postsArr.length === 0 && params.value > 1) {
        console.warn(`No posts found on page ${params.value}, redirecting to page 1`)
        params.value = 1
        return { data: [], meta: { current_page: 1, last_page: 1, total_posts: 0, links: [] } } as any
      }
      
      const mapped: BlogResponse = {
        data: postsArr.map((p: any) => ({
          id: p.id,
          slug: p.slug,
          title: typeof p.title === 'string' ? p.title.replace(/<[^>]*>/g, '').trim() : (p.slug || 'Blog Post'),
          publish_at: p.date || p.publish_at,
          featured_image: getSafeImage(p?.featured_image || p?.image, p?.title, p?.slug),
        })),
        meta: {
          current_page: pagination.page || params.value,
          last_page: pagination.totalPages || 1,
          total_posts: pagination.total || postsArr.length,
          links: [{ active: false, label: '', url: null }]
        }
      };
      
      // console.log('ðŸŽ¯ Mapped Data:', mapped)


      if (!mapped.data.length) {
        if (!q) {
          const nowIso = new Date().toISOString();
          const seeds = [
            { slug: 'jasa-paypal', title: 'Jasa PayPal: Solusi Pembayaran Online Aman' },
            { slug: 'jasa-bayar-paypal', title: 'Jasa Bayar PayPal Cepat & Terpercaya' },
            { slug: 'jasa-transfer-paypal', title: 'Jasa Transfer PayPal untuk Transaksi Global' },
            { slug: 'jasa-domain-namecheap', title: 'Jasa Domain Namecheap: Panduan & Tips' },
            { slug: 'jasa-namecheap', title: 'Jasa Namecheap: Keamanan Transaksi Online' },
            { slug: 'jasa-top-up-paypal', title: 'Jasa Top Up PayPal: Praktis & Aman' },
            { slug: 'jasa-verifikasi-paypal', title: 'Jasa Verifikasi PayPal: Mudah & Tepat' },
            { slug: 'jasa-domain-namesilo', title: 'Jasa Domain NameSilo: Pilihan Tepat' }
          ];
          const fallbackData = seeds.map((s, i) => ({
            id: -3000 - i,
            slug: s.slug,
            title: s.title,
            publish_at: nowIso,
            featured_image: getSafeImage('', s.title, s.slug)
          }));
          return {
            data: fallbackData,
            meta: { current_page: 1, last_page: 1, total_posts: fallbackData.length, links: [] }
          } as any;
        }
        return { data: [], meta: { current_page: params.value, last_page: 1, total_posts: 0, links: [] } } as any;
      }
      return mapped;
    } catch (e) {
      console.warn('Blog fetch failed, using fallback when possible:', e);
      const q = (searchQuery.value || '').trim();
      if (!q) {
        const nowIso = new Date().toISOString();
        const seeds = [
          { slug: 'jasa-paypal', title: 'Jasa PayPal: Solusi Pembayaran Online Aman' },
          { slug: 'jasa-bayar-paypal', title: 'Jasa Bayar PayPal Cepat & Terpercaya' },
          { slug: 'jasa-transfer-paypal', title: 'Jasa Transfer PayPal untuk Transaksi Global' },
          { slug: 'jasa-domain-namecheap', title: 'Jasa Domain Namecheap: Panduan & Tips' },
          { slug: 'jasa-namecheap', title: 'Jasa Namecheap: Keamanan Transaksi Online' },
          { slug: 'jasa-top-up-paypal', title: 'Jasa Top Up PayPal: Praktis & Aman' },
          { slug: 'jasa-verifikasi-paypal', title: 'Jasa Verifikasi PayPal: Mudah & Tepat' },
          { slug: 'jasa-domain-namesilo', title: 'Jasa Domain NameSilo: Pilihan Tepat' }
        ];
        const fallbackData = seeds.map((s, i) => ({
          id: -4000 - i,
          slug: s.slug,
          title: s.title,
          publish_at: nowIso,
          featured_image: getSafeImage('', s.title, s.slug)
        }));
        return {
          data: fallbackData,
          meta: { current_page: 1, last_page: 1, total_posts: fallbackData.length, links: [] }
        } as any;
      }
      return { data: [], meta: { current_page: params.value, last_page: 1, total_posts: 0, links: [] } } as any;
    } finally {
      clearInterval(loadingInterval)
      stopLoading()
    }
  },
  { 
    server: !isDev, 
    lazy: isDev,
    default: () => ({
      data: [],
      meta: { current_page: 1, last_page: 1, total_posts: 0, links: [] }
    })
  }
);

// Sync params with route query changes (back/forward navigation)
watch(() => route.query.page, (newVal: string | string[] | undefined) => {
  const pageNum = Number(newVal as string) || 1;
  if (pageNum !== params.value) {
    params.value = pageNum;
    refresh();
  }
});

// Sync search query (?q=) with local state and refresh when it changes
watch(() => route.query.q, (newQ: string | string[] | undefined) => {
  const val = typeof newQ === 'string' ? (newQ as string) : '';
  if (val !== searchQuery.value) {
    searchQuery.value = val;
  }
  // Reset local page state to 1 when search changes
  if (params.value !== 1) params.value = 1;
  refresh();
});

const changePage = async (page: number) => {
  const last = blogs.value?.meta.last_page || 1;
  if (page < 1 || page > last) {
    return;
  }

  const loadingInterval = startLoading(`Memuat halaman ${page}...`)

  try {
  // Update local state
  params.value = page;

  // Sync the URL query (?page=) for deep linking
  try {
    const q: Record<string, any> = { ...route.query, page: String(page) };
    // Avoid adding page=1 to keep clean URL
    if (page === 1) {
      delete q.page;
    }
    await router.replace({ query: q });
  } catch (err) {
    console.debug('Pagination route replace skipped', err);
  }

  // Refresh the data
  await refresh();
  } finally {
    clearInterval(loadingInterval)
    stopLoading()
  }

  // Smooth scroll to the blog section on navigation (client-only)
  if (import.meta.client) {
    const el = document.getElementById('blog-page');
    if (el) {
      el.scrollIntoView({ behavior: 'smooth', block: 'start' });
    } else {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
  }
};

const goToPreviousPage = () => {
  if (blogs.value?.meta.current_page && blogs.value.meta.current_page > 1) {
    changePage(blogs.value.meta.current_page - 1);
  }
};

const goToNextPage = () => {
  if (blogs.value?.meta.current_page && blogs.value?.meta.last_page &&
      blogs.value.meta.current_page < blogs.value.meta.last_page) {
    changePage(blogs.value.meta.current_page + 1);
  }
};

// Show all posts functionality
const showAllPosts = async () => {
  await changeViewLimit(0); // 0 means all posts
};

// Back to pagination functionality
const backToPagination = async () => {
  await changeViewLimit(8); // Back to default 8 posts per page
};

const mobilePages = computed(() => {
  const last = blogs.value?.meta.last_page || 1;
  const current = blogs.value?.meta.current_page || 1;

  // Show all pages if count is small
  if (last <= 6) {
    return Array.from({ length: last }, (_, i) => i + 1);
  }

  const pages: (number | string)[] = [1, 2];

  // Left gap handling
  if (current > 4) {
    pages.push('â€¦');
  } else if (current === 4) {
    pages.push(3);
  }

  // Middle current page (only when not in the first/last two)
  if (current > 2 && current < last - 1) {
    pages.push(current);
  }

  // Right gap handling
  if (current < last - 3) {
    pages.push('â€¦');
  } else if (current === last - 3) {
    pages.push(last - 3);
  }

  pages.push(last - 1, last);

  // Remove adjacent duplicates (e.g., when current === last-3)
  return pages.filter((item, idx, arr) => idx === 0 || item !== arr[idx - 1]);
});

const desktopPages = computed<(number | string)[]>(() => {
  // Mirror the mobile pagination pattern for desktop (always show 1,2, current when applicable, and last-1,last with ellipses)
  return mobilePages.value;
});

// SEO: rel prev/next for blog listing (only on /blog path)
const baseListUrl = 'https://jasapembayaran.com/blog'
const current = computed(() => blogs.value?.meta?.current_page || params.value || 1)
const last = computed(() => blogs.value?.meta?.last_page || 1)
const prevHref = computed(() => {
  if (route.path !== '/blog') return null
  if (current.value <= 1) return null
  const p = current.value - 1
  return p > 1 ? `${baseListUrl}?page=${p}` : baseListUrl
})
const nextHref = computed(() => {
  if (route.path !== '/blog') return null
  if (current.value >= last.value) return null
  const p = current.value + 1
  return `${baseListUrl}?page=${p}`
})

// Pagination summary computed (range/status under pagination)
const perPage = computed(() => 8)
const currentPage = computed(() => blogs.value?.meta?.current_page || 1)
const lastPage = computed(() => blogs.value?.meta?.last_page || 1)
const currentCount = computed(() => blogs.value?.data?.length || 0)
const startIndexDisplay = computed(() => {
  const start = (currentPage.value - 1) * perPage.value + 1
  return currentCount.value > 0 ? Math.max(1, start) : 0
})
const endIndexDisplay = computed(() => {
  return currentCount.value > 0 ? startIndexDisplay.value + currentCount.value - 1 : 0
})
const estimatedTotalItems = computed(() => lastPage.value * perPage.value)
const totalItemsDisplay = computed(() => {
  if (currentCount.value === 0) return 0
  return currentPage.value === lastPage.value ? endIndexDisplay.value : estimatedTotalItems.value
})
// True total posts from API
const totalPostsDisplay = computed(() => (blogs.value?.meta as any)?.total_posts ?? 0)
// Calculate real total from current data
const realTotalFromData = computed(() => {
  if (!blogs.value?.data) return 0
  const currentDataLength = blogs.value.data.length
  const currentPage = Number(route.query.page) || 1
  const perPage = 8 // Fixed per page for blog listing
  
  // If we have less than perPage items, this is the last page
  if (currentDataLength < perPage) {
    return (currentPage - 1) * perPage + currentDataLength
  }
  
  // If we have exactly perPage items, there might be more pages
  // Estimate based on current page and data length
  if (currentDataLength === perPage) {
    // Assume there might be more pages, but be conservative
    return Math.max(currentPage * perPage, currentDataLength)
  }
  
  // Default fallback
  return currentDataLength
})
// Prefer real total from API; fallback to real calculation; final fallback to estimated
const grandTotalDisplay = computed(() => {
  if (totalPostsDisplay.value > 0) return totalPostsDisplay.value
  if (realTotalFromData.value > 0) return realTotalFromData.value
  return estimatedTotalItems.value
})

useHead(() => ({
  link: [
    ...(prevHref.value ? [{ rel: 'prev', href: prevHref.value }] : []),
    ...(nextHref.value ? [{ rel: 'next', href: nextHref.value }] : [])
  ]
}))

// Notify layout loader when blog list content is ready
const notifyBlogContentLoaded = () => {
  if (import.meta.client) {
    try { window.dispatchEvent(new Event('blog-search:loaded')) } catch {}
  }
}

watchEffect(() => {
  // console.log('ðŸ“ˆ Blog Status:', blogStatus.value)
  // console.log('ðŸ“š Blogs Data:', blogs.value)
  if (blogStatus.value === 'success') {
    nextTick(() => notifyBlogContentLoaded())
  }
})

// Auto slide functions
const startAutoSlide = () => {
  if (slideInterval.value) clearInterval(slideInterval.value)
  slideInterval.value = setInterval(() => {
    if (isAutoSliding.value && totalSlides.value > 1) {
      currentSlide.value = (currentSlide.value + 1) % totalSlides.value
    }
  }, 3000) // 3 seconds
}

const stopAutoSlide = () => {
  if (slideInterval.value) {
    clearInterval(slideInterval.value)
    slideInterval.value = null
  }
}

const goToSlide = (slideIndex: number) => {
  currentSlide.value = slideIndex
  stopAutoSlide()
  setTimeout(() => {
    if (isAutoSliding.value) startAutoSlide()
  }, 1000)
}

// Start auto slide when component mounts
onMounted(() => {
  if (isAutoSliding.value) startAutoSlide()
})

// Cleanup on unmount
onBeforeUnmount(() => {
  stopAutoSlide()
})
</script>

<template>
  <UPageSection
    id="blog-page"
    variant="subtle"
    class="@container mx-0"
    :ui="{
      container:
        'py-6 px-3 sm:px-4 lg:pt-6 lg:pb-14 sm:gap-5 bg-gradient-to-br from-white via-blue-50/30 to-purple-50/30 dark:from-gray-900 dark:via-blue-900/20 dark:to-purple-900/20 shadow-2xl border border-gradient-to-r from-blue-200/50 via-purple-200/50 to-pink-200/50 dark:from-blue-700/50 dark:via-purple-700/50 dark:to-pink-700/50 overflow-hidden rounded-3xl relative backdrop-blur-sm',
    }"
  >
    <!-- Super Cool Animated Background -->
    <div class="absolute inset-0 overflow-hidden pointer-events-none">
      <!-- Floating orbs with animation -->
      <div class="absolute top-10 right-10 w-40 h-40 bg-gradient-to-r from-blue-400/20 to-purple-400/20 rounded-full animate-pulse blur-xl"></div>
      <div class="absolute top-20 right-32 w-24 h-24 bg-gradient-to-r from-pink-400/20 to-purple-400/20 rounded-full animate-bounce blur-lg"></div>
      <div class="absolute bottom-10 left-10 w-32 h-32 bg-gradient-to-r from-emerald-400/20 to-cyan-400/20 rounded-full animate-pulse blur-xl"></div>
      <div class="absolute bottom-20 left-32 w-20 h-20 bg-gradient-to-r from-yellow-400/20 to-red-400/20 rounded-full animate-bounce blur-lg"></div>
      
      <!-- Gradient mesh overlay -->
      <div class="absolute inset-0 bg-gradient-to-br from-transparent via-blue-100/10 to-purple-100/10 dark:via-blue-900/5 dark:to-purple-900/5"></div>
      
      <!-- Animated grid pattern -->
      <div class="absolute inset-0 opacity-5 dark:opacity-10">
        <div class="absolute inset-0" style="background-image: radial-gradient(circle at 1px 1px, rgba(59, 130, 246, 0.3) 1px, transparent 0); background-size: 20px 20px; animation: grid-move 20s linear infinite;"></div>
      </div>
    </div>

    <template #title>
      <UiTitleBase>
        <div class="flex items-center gap-4 justify-center relative z-10">
          <div class="relative">
            <div class="absolute inset-0 bg-gradient-to-r from-cyan-400 to-blue-500 rounded-full blur-lg opacity-60 animate-pulse"></div>
            <UIcon name="i-lucide-newspaper" class="text-cyan-300 size-8 md:size-10 relative z-10 drop-shadow-lg" />
          </div>
          <span class="text-transparent bg-clip-text bg-gradient-to-r from-cyan-300 via-blue-300 to-purple-300 font-bold relative text-xl md:text-2xl drop-shadow-lg">
            âœ¨ Blog <span class="text-yellow-300">Terbaru</span> âœ¨
            <span class="absolute -bottom-2 left-0 w-full h-1.5 bg-gradient-to-r from-cyan-400 via-blue-500 to-purple-500 rounded-full shadow-lg"></span>
          </span>
          <div class="relative">
            <div class="absolute inset-0 bg-gradient-to-r from-purple-400 to-pink-500 rounded-full blur-lg opacity-60 animate-pulse" style="animation-delay: 0.5s;"></div>
            <UIcon name="i-lucide-rss" class="text-purple-300 size-8 md:size-10 relative z-10 drop-shadow-lg" />
          </div>
        </div>
      </UiTitleBase>
    </template>
    <template #description>
      <div class="max-w-3xl mx-auto px-3 sm:px-4 mb-2 relative z-10">
        <div class="text-center">
          <p class="text-cyan-100 text-base md:text-lg leading-relaxed font-medium drop-shadow-lg">
            ðŸš€ <span class="text-yellow-300 font-bold">Temukan Dunia Digital Terbaru!</span> ðŸš€
          </p>
          <p class="text-blue-200 text-sm md:text-base leading-relaxed mt-3 drop-shadow-md">
            Jelajahi artikel eksklusif tentang teknologi pembayaran, tips keamanan digital, dan inovasi PAYTECH terdepan. 
            <span class="text-purple-300 font-semibold">Bergabunglah dengan ribuan pembaca cerdas</span> yang selalu update dengan tren terbaru!
          </p>
          <div class="flex items-center justify-center space-x-2 mt-4">
            <div class="w-2 h-2 bg-cyan-400 rounded-full animate-pulse"></div>
            <div class="w-2 h-2 bg-blue-400 rounded-full animate-pulse" style="animation-delay: 0.2s;"></div>
            <div class="w-2 h-2 bg-purple-400 rounded-full animate-pulse" style="animation-delay: 0.4s;"></div>
          </div>
        </div>
      </div>
    </template>

    <!-- Loading Bar -->
    <div v-if="isLoading" class="fixed top-0 left-0 right-0 z-50 bg-gradient-to-r from-blue-600 to-purple-600 shadow-lg">
      <div class="h-1 bg-gradient-to-r from-blue-400 to-purple-400 transition-all duration-300 ease-out" 
           :style="{ width: loadingProgress + '%' }"></div>
      <div class="px-4 py-2 text-center">
        <p class="text-white text-sm font-medium">{{ loadingMessage }}</p>
      </div>
    </div>

    <div class="flex justify-center flex-wrap gap-4">
      <template v-if="blogStatus === 'pending'">
        <div class="news-grid">
          <div v-for="i in 8" :key="i" class="news-card relative overflow-hidden rounded-2xl shadow-lg bg-white dark:bg-gray-800/90 border-2 border-blue-100 dark:border-blue-900/30 h-full flex flex-col">
            <div class="absolute top-0 left-0 w-full h-1.5 bg-gradient-to-r from-blue-400 to-blue-600 z-10"></div>
            <USkeleton class="w-full rounded-t-2xl aspect-[16/9]" />
            <div class="p-4">
              <USkeleton class="h-6 w-full mb-2" />
              <USkeleton class="h-4 w-1/3" />
            </div>
          </div>
        </div>
      </template>

      <template v-else>
        <div class="w-full space-y-8">
          <!-- Show message when no blog posts are available -->
          <div v-if="!blogs?.data || blogs.data.length === 0" class="w-full text-center py-8">
            <div class="bg-white dark:bg-gray-800/90 p-6 rounded-2xl shadow-lg border-2 border-blue-100 dark:border-blue-900/30 max-w-2xl mx-auto">
              <UIcon name="i-lucide-info" class="text-blue-500 size-12 mx-auto mb-4" />
              <h3 class="text-xl font-bold text-gray-800 dark:text-gray-200 mb-2">Blog Sedang Dalam Pemeliharaan</h3>
              <p class="text-gray-600 dark:text-gray-300 mb-4">
                Mohon maaf, konten blog kami sedang dalam pemeliharaan dan tidak tersedia untuk sementara waktu.
                Silakan kunjungi kembali nanti untuk membaca artikel terbaru dari kami.
              </p>
              <div class="flex gap-3 justify-center">
                <button @click="refresh()" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors">
                  ðŸ”„ Refresh Data
                </button>
              <NuxtLink to="/" class="inline-block px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">
                Kembali ke Home
              </NuxtLink>
              </div>
            </div>
          </div>

          <!-- Show blog posts if available -->
          <div v-else>
            <!-- Show All Posts Grid (when showAll is true) -->
            <div v-if="isShowAllMode" class="blog-grid">
            <div class="col-span-full text-center text-sm text-blue-600 dark:text-blue-400 mb-4 font-semibold">
              ðŸ“š Menampilkan {{ Math.min(blogs?.data?.length || 0, 50) }} dari {{ blogs?.data?.length || 0 }} Artikel (Maksimal 50 untuk performa)
            </div>
            <div
              v-for="(blog, i) in blogs?.data?.slice(0, 50)"
              :key="blog.slug || blog.id"
              :data-index="i"
              @click="navigateToArticle(blog)"
              @dblclick="navigateToArticle(blog)"
              class="blog-card relative overflow-hidden rounded-2xl shadow-2xl hover:shadow-purple-500/25 transition-all duration-500 bg-gradient-to-br from-white via-blue-50/20 to-purple-50/20 dark:from-gray-800 dark:via-blue-900/20 dark:to-purple-900/20 border-2 border-gradient-to-r from-blue-200/60 via-purple-200/60 to-pink-200/60 dark:from-blue-600/60 dark:via-purple-600/60 dark:to-pink-600/60 group h-full flex flex-col cursor-pointer hover:border-purple-400 dark:hover:border-purple-500 hover:-translate-y-3 hover:scale-[1.03] backdrop-blur-md hover:glow"
            >
              <!-- Enhanced top accent line with gradient -->
              <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-500 z-10 shadow-lg"></div>
              
              <!-- Clean corner accents -->
              <div class="absolute top-0 right-0 w-16 h-16 bg-blue-50/60 dark:bg-blue-900/20 rounded-bl-2xl"></div>
              <div class="absolute bottom-0 left-0 w-16 h-16 bg-indigo-50/60 dark:bg-indigo-900/20 rounded-tr-2xl"></div>

              <!-- Clean Image container -->
              <div class="relative bg-gray-100 dark:bg-gray-700 overflow-hidden h-48 rounded-t-2xl">
                <!-- Image with enhanced styling -->
                <img
                  :src="getCardImage(blog)"
                  :alt="blog.title"
                  :data-card-id="blog.slug || blog.id"
                  class="w-full h-48 object-cover transition-transform duration-300 group-hover:scale-105"
                  loading="lazy"
                  decoding="async"
                  @error="onCardImgError"
                  @load="onCardImgLoad"
                  style="background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);"
                />
                
                <!-- Enhanced overlay gradient -->
                <div class="absolute inset-0 bg-gradient-to-t from-black/20 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                
                <!-- Blog icon removed as requested -->
                
                <!-- Clean Fallback placeholder -->
                <div class="fallback-placeholder absolute inset-0 bg-gray-200 dark:bg-gray-600 flex items-center justify-center" style="display: none;">
                  <div class="text-center text-gray-500 dark:text-gray-400">
                    <div class="w-12 h-12 mx-auto mb-2 bg-gray-300 dark:bg-gray-500 rounded-xl flex items-center justify-center">
                      <UIcon name="i-lucide-image" class="text-white text-lg" />
                    </div>
                    <p class="text-xs font-medium">Gambar Artikel</p>
                  </div>
                </div>
              </div>

              <!-- Content -->
              <div class="blog-card-body bg-white dark:bg-gray-800 px-4 py-4 text-black dark:text-white flex-grow relative z-10">
                <!-- Article Title with Full Text Display -->
                <div class="mb-4 group/title">
                  <h3 
                    class="text-lg font-bold text-gray-900 dark:text-white leading-tight mb-2 relative overflow-hidden transition-all duration-300"
                    style="display: -webkit-box; -webkit-line-clamp: 2; line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis; line-height: 1.4;"
                  >
                    <!-- Enhanced text with better contrast -->
                    <span class="relative z-10 transition-all duration-500 group-hover/title:text-transparent group-hover/title:bg-clip-text group-hover/title:bg-gradient-to-r group-hover/title:from-blue-600 group-hover/title:via-purple-600 group-hover/title:to-pink-600 font-bold text-gray-900 dark:text-white">
                      {{ blog.title || 'Artikel Menarik' }}
                    </span>
                    <!-- Shimmer effect overlay -->
                    <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover/title:translate-x-full transition-transform duration-1000 ease-out"></div>
                    <!-- Glow effect -->
                    <div class="absolute inset-0 bg-gradient-to-r from-blue-500/20 via-purple-500/20 to-pink-500/20 opacity-0 group-hover/title:opacity-100 blur-sm transition-all duration-500"></div>
                  </h3>
                  
                  <!-- Enhanced gradient line with animation -->
                  <div class="relative h-1 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                    <div class="absolute inset-0 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 rounded-full transform -translate-x-full group-hover/title:translate-x-0 transition-transform duration-700 ease-out"></div>
                    <div class="absolute inset-0 bg-gradient-to-r from-pink-500 via-purple-500 to-blue-500 rounded-full transform translate-x-full group-hover/title:translate-x-0 transition-transform duration-700 ease-out delay-200"></div>
                  </div>
                  
                  <!-- Click indicator -->
                  <div class="absolute top-0 right-0 opacity-0 group-hover/title:opacity-100 transition-opacity duration-300">
                    <div class="w-6 h-6 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center">
                      <UIcon name="i-lucide-maximize-2" class="w-3 h-3 text-white" />
                    </div>
                  </div>
                </div>
                
                <!-- Title popup removed as cards are now fully clickable -->
                
                <!-- Enhanced Meta information with Vibrant Colors -->
                <div class="blog-card-meta flex flex-col space-y-3">
                  <!-- Date with vibrant styling -->
                  <div class="flex items-center space-x-3 bg-gradient-to-r from-purple-100 via-violet-100 to-indigo-100 dark:from-purple-900/40 dark:via-violet-900/40 dark:to-indigo-900/40 px-4 py-3 rounded-xl border-2 border-purple-300/60 dark:border-purple-600/60 shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 group/meta">
                    <div class="w-4 h-4 bg-gradient-to-r from-purple-500 to-violet-500 rounded-full shadow-md animate-pulse"></div>
                    <UIcon name="i-lucide-calendar-days" class="w-5 h-5 text-purple-600 dark:text-purple-400 group-hover/meta:scale-110 transition-transform duration-300" />
                    <span class="font-bold text-sm text-purple-800 dark:text-purple-200 group-hover/meta:text-purple-900 dark:group-hover/meta:text-purple-100 transition-colors duration-300">
                      {{ formatDateSafe(blog.publish_at) || '30 September 2025' }}
                    </span>
                  </div>
                  
                  <!-- Time with vibrant styling -->
                  <div class="flex items-center space-x-3 bg-gradient-to-r from-emerald-100 via-teal-100 to-cyan-100 dark:from-emerald-900/40 dark:via-teal-900/40 dark:to-cyan-900/40 px-4 py-3 rounded-xl border-2 border-emerald-300/60 dark:border-emerald-600/60 shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 group/meta">
                    <div class="w-4 h-4 bg-gradient-to-r from-emerald-500 to-teal-500 rounded-full shadow-md animate-pulse"></div>
                    <UIcon name="i-lucide-clock" class="w-5 h-5 text-emerald-600 dark:text-emerald-400 group-hover/meta:scale-110 transition-transform duration-300" />
                    <span class="font-bold text-sm text-emerald-800 dark:text-emerald-200 group-hover/meta:text-emerald-900 dark:group-hover/meta:text-emerald-100 transition-colors duration-300">
                      {{ formatTimeSafe(blog.publish_at) }} WIB
                    </span>
                  </div>
                </div>
                
                <!-- Super Cool Read more button -->
                <div class="mt-4 text-center">
                  <div class="inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-purple-500 via-pink-500 to-red-500 hover:from-purple-600 hover:via-pink-600 hover:to-red-600 text-white text-sm font-bold rounded-2xl opacity-0 group-hover:opacity-100 transition-all duration-500 transform translate-y-3 group-hover:translate-y-0 shadow-2xl hover:shadow-purple-500/25 hover:scale-105 relative overflow-hidden">
                    <!-- Animated background -->
                    <div class="absolute inset-0 bg-gradient-to-r from-cyan-400 via-blue-500 to-purple-600 opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                    <!-- Shimmer effect -->
                    <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000 ease-out"></div>
                    <span class="relative z-10">Baca Artikel</span>
                    <UIcon name="i-lucide-arrow-right" class="w-4 h-4 relative z-10 group-hover:translate-x-1 transition-transform duration-300" />
                  </div>
                </div>
              </div>

              <!-- Enhanced bottom accent with glow effect -->
              <div class="absolute bottom-0 left-0 right-0 h-2 bg-gradient-to-r from-transparent via-blue-400 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-lg"></div>
              
              <!-- Subtle border glow on hover -->
              <div class="absolute inset-0 rounded-3xl border-2 border-transparent group-hover:border-blue-300/50 dark:group-hover:border-blue-400/50 transition-all duration-300 pointer-events-none"></div>
            </div>
          </div>

          <!-- Auto Slider Container (default pagination view) -->
          <div v-else class="relative overflow-hidden">
            <div 
              class="flex transition-transform duration-500 ease-in-out"
              :style="{ transform: `translateX(-${currentSlide * 100}%)` }"
            >
              <div 
                v-for="slideIndex in totalSlides" 
                :key="slideIndex"
                class="w-full flex-shrink-0"
              >
                <div class="blog-grid">
                  <div
                    v-for="(blog, i) in blogs?.data?.slice((slideIndex - 1) * 8, slideIndex * 8)"
                    :key="blog.slug || blog.id"
                    :data-index="i"
                    @click="navigateToArticle(blog)"
                    @dblclick="navigateToArticle(blog)"
                    class="blog-card relative overflow-hidden rounded-2xl shadow-2xl hover:shadow-purple-500/25 transition-all duration-500 bg-gradient-to-br from-white via-blue-50/20 to-purple-50/20 dark:from-gray-800 dark:via-blue-900/20 dark:to-purple-900/20 border-2 border-gradient-to-r from-blue-200/60 via-purple-200/60 to-pink-200/60 dark:from-blue-600/60 dark:via-purple-600/60 dark:to-pink-600/60 group h-full flex flex-col cursor-pointer hover:border-purple-400 dark:hover:border-purple-500 hover:-translate-y-3 hover:scale-[1.03] backdrop-blur-md hover:glow"
                  >
                    <!-- Enhanced top accent line with gradient -->
                    <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-500 z-10 shadow-lg"></div>
                    
                    <!-- Clean corner accents -->
                    <div class="absolute top-0 right-0 w-16 h-16 bg-blue-50/60 dark:bg-blue-900/20 rounded-bl-2xl"></div>
                    <div class="absolute bottom-0 left-0 w-16 h-16 bg-indigo-50/60 dark:bg-indigo-900/20 rounded-tr-2xl"></div>

                    <!-- Clean Image container -->
                    <div class="relative bg-gray-100 dark:bg-gray-700 overflow-hidden h-48 rounded-t-2xl">
                      <!-- Image with enhanced styling -->
                      <img
                        :src="getCardImage(blog)"
                        :alt="blog.title"
                        :data-card-id="blog.slug || blog.id"
                        class="w-full h-48 object-cover transition-transform duration-300 group-hover:scale-105"
                        loading="eager"
                        decoding="async"
                        @error="onCardImgError"
                        @load="onCardImgLoad"
                        style="background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);"
                      />
                      
                      <!-- Enhanced overlay gradient -->
                      <div class="absolute inset-0 bg-gradient-to-t from-black/20 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                      
                      <!-- Blog icon removed as requested -->
                      
                      <!-- Clean Fallback placeholder -->
                      <div class="fallback-placeholder absolute inset-0 bg-gray-200 dark:bg-gray-600 flex items-center justify-center" style="display: none;">
                        <div class="text-center text-gray-500 dark:text-gray-400">
                          <div class="w-12 h-12 mx-auto mb-2 bg-gray-300 dark:bg-gray-500 rounded-xl flex items-center justify-center">
                            <UIcon name="i-lucide-image" class="text-white text-lg" />
                          </div>
                          <p class="text-xs font-medium">Gambar Artikel</p>
                        </div>
                      </div>
                    </div>

                    <!-- Content -->
                    <div class="blog-card-body bg-white dark:bg-gray-800 px-5 py-4 text-black dark:text-white flex-grow relative z-10">
                      <!-- Article Title with Super Cool Hover Effects -->
                      <div class="mb-4 group/title">
                        <h3 
                          class="text-lg font-bold text-gray-900 dark:text-white leading-tight mb-2 relative overflow-hidden"
                          :title="blog.title"
                          style="display: -webkit-box; -webkit-line-clamp: 2; line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis; line-height: 1.4;"
                        >
                          <!-- Animated background gradient on hover -->
                          <span class="relative z-10 transition-all duration-500 group-hover/title:text-transparent group-hover/title:bg-clip-text group-hover/title:bg-gradient-to-r group-hover/title:from-blue-600 group-hover/title:via-purple-600 group-hover/title:to-pink-600">
                            {{ blog.title || 'Artikel Menarik' }}
                          </span>
                          <!-- Shimmer effect overlay -->
                          <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover/title:translate-x-full transition-transform duration-1000 ease-out"></div>
                          <!-- Glow effect -->
                          <div class="absolute inset-0 bg-gradient-to-r from-blue-500/20 via-purple-500/20 to-pink-500/20 opacity-0 group-hover/title:opacity-100 blur-sm transition-all duration-500"></div>
                        </h3>
                        <!-- Enhanced gradient line with animation -->
                        <div class="relative h-1 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                          <div class="absolute inset-0 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 rounded-full transform -translate-x-full group-hover/title:translate-x-0 transition-transform duration-700 ease-out"></div>
                          <div class="absolute inset-0 bg-gradient-to-r from-pink-500 via-purple-500 to-blue-500 rounded-full transform translate-x-full group-hover/title:translate-x-0 transition-transform duration-700 ease-out delay-200"></div>
                        </div>
                      </div>
                      
                      <!-- Enhanced Meta information with Vibrant Colors -->
                      <div class="blog-card-meta flex flex-col space-y-3">
                        <!-- Date with vibrant styling -->
                        <div class="flex items-center space-x-3 bg-gradient-to-r from-purple-100 via-violet-100 to-indigo-100 dark:from-purple-900/40 dark:via-violet-900/40 dark:to-indigo-900/40 px-4 py-3 rounded-xl border-2 border-purple-300/60 dark:border-purple-600/60 shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 group/meta">
                          <div class="w-4 h-4 bg-gradient-to-r from-purple-500 to-violet-500 rounded-full shadow-md animate-pulse"></div>
                          <UIcon name="i-lucide-calendar-days" class="w-5 h-5 text-purple-600 dark:text-purple-400 group-hover/meta:scale-110 transition-transform duration-300" />
                          <span class="font-bold text-sm text-purple-800 dark:text-purple-200 group-hover/meta:text-purple-900 dark:group-hover/meta:text-purple-100 transition-colors duration-300">
                            {{ formatDateSafe(blog.publish_at) || '30 September 2025' }}
                          </span>
                        </div>
                        
                        <!-- Time with vibrant styling -->
                        <div class="flex items-center space-x-3 bg-gradient-to-r from-emerald-100 via-teal-100 to-cyan-100 dark:from-emerald-900/40 dark:via-teal-900/40 dark:to-cyan-900/40 px-4 py-3 rounded-xl border-2 border-emerald-300/60 dark:border-emerald-600/60 shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 group/meta">
                          <div class="w-4 h-4 bg-gradient-to-r from-emerald-500 to-teal-500 rounded-full shadow-md animate-pulse"></div>
                          <UIcon name="i-lucide-clock" class="w-5 h-5 text-emerald-600 dark:text-emerald-400 group-hover/meta:scale-110 transition-transform duration-300" />
                          <span class="font-bold text-sm text-emerald-800 dark:text-emerald-200 group-hover/meta:text-emerald-900 dark:group-hover/meta:text-emerald-100 transition-colors duration-300">
                            {{ formatTimeSafe(blog.publish_at) }} WIB
                          </span>
                        </div>
                      </div>
              
                      <!-- Super Cool Read more button -->
                      <div class="mt-3 text-center">
                        <div class="inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-purple-500 via-pink-500 to-red-500 hover:from-purple-600 hover:via-pink-600 hover:to-red-600 text-white text-sm font-bold rounded-2xl opacity-0 group-hover:opacity-100 transition-all duration-500 transform translate-y-3 group-hover:translate-y-0 shadow-2xl hover:shadow-purple-500/25 hover:scale-105 relative overflow-hidden">
                          <!-- Animated background -->
                          <div class="absolute inset-0 bg-gradient-to-r from-cyan-400 via-blue-500 to-purple-600 opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                          <!-- Shimmer effect -->
                          <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000 ease-out"></div>
                          <span class="relative z-10">Baca Artikel</span>
                          <UIcon name="i-lucide-arrow-right" class="w-4 h-4 relative z-10 group-hover:translate-x-1 transition-transform duration-300" />
                        </div>
                      </div>
                    </div>

                    <!-- Enhanced bottom accent with glow effect -->
                    <div class="absolute bottom-0 left-0 right-0 h-2 bg-gradient-to-r from-transparent via-blue-400 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-lg"></div>
                    
                    <!-- Subtle border glow on hover -->
                    <div class="absolute inset-0 rounded-3xl border-2 border-transparent group-hover:border-blue-300/50 dark:group-hover:border-blue-400/50 transition-all duration-300 pointer-events-none"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>

            <!-- Slider Navigation Controls - REMOVED as requested -->
          </div>

        <!-- Super Cool Search Box -->
        <div class="mt-8 w-full">
          <div class="max-w-4xl mx-auto relative search-container">
            <div class="bg-gradient-to-r from-white/90 via-blue-50/90 to-purple-50/90 dark:from-gray-800/90 dark:via-blue-900/90 dark:to-purple-900/90 backdrop-blur-xl rounded-3xl p-6 shadow-2xl border border-white/20 dark:border-gray-700/50">
                <!-- Search Header -->
                <div class="text-center mb-6">
                  <h3 class="text-2xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent mb-2">
                  ðŸ”Â Pencarian Artikel
                </h3>
                <p class="text-gray-600 dark:text-gray-400 text-sm">
                  Temukan artikel terbaru dan terpopuler
                </p>
              </div>
              
              <!-- Search Input -->
              <div class="relative group">
                <div class="absolute inset-0 bg-gradient-to-r from-blue-500/20 via-purple-500/20 to-pink-500/20 rounded-2xl blur-sm opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                <div class="relative bg-white/80 dark:bg-gray-800/80 backdrop-blur-md rounded-2xl border-2 border-blue-200/50 dark:border-blue-700/50 overflow-hidden">
                  <input
                    v-model="searchModel"
                    @input="onSearchInput"
                    @focus="showSearchDropdown = true"
                    @keyup.enter="performSearch"
                    placeholder="ðŸ”Â Cari artikel blog terbaru..."
                    class="w-full h-14 pl-6 pr-20 text-gray-900 dark:text-white bg-transparent border-0 focus:outline-none focus:ring-0 placeholder:text-gray-700 dark:placeholder:text-gray-300 text-lg font-medium"
                  />
                  <button
                    @click="performSearch"
                    class="absolute right-2 top-1/2 -translate-y-1/2 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 hover:from-blue-600 hover:via-purple-600 hover:to-pink-600 text-white px-6 py-2 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl"
                  >
                    Cari
                  </button>
                </div>
              </div>
              
              <!-- Search Suggestions & History -->
              <div v-if="showSearchDropdown" class="mt-4 bg-white/95 dark:bg-gray-800/95 backdrop-blur-md rounded-2xl border border-gray-200/50 dark:border-gray-700/50 shadow-xl overflow-hidden z-50">
                <!-- Search History -->
                <div v-if="searchHistory.length > 0 && !searchModel" class="p-4">
                  <h4 class="text-sm font-bold text-gray-800 dark:text-gray-200 mb-3 flex items-center gap-2">
                    <UIcon name="i-lucide-history" class="w-4 h-4 text-blue-600 dark:text-blue-400" />
                    Pencarian Terakhir
                  </h4>
                  <div class="space-y-2">
                    <button
                      v-for="(term, index) in searchHistory.slice(0, 5)"
                      :key="index"
                      @click="searchModel = term; performSearch()"
                      class="w-full text-left px-3 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded-lg transition-colors duration-200 hover:text-blue-700 dark:hover:text-blue-300"
                    >
                      {{ term }}
                    </button>
                  </div>
                </div>
                
                <!-- Search Suggestions -->
                <div v-if="searchSuggestions.length > 0" class="p-4">
                  <h4 class="text-sm font-bold text-gray-800 dark:text-gray-200 mb-3 flex items-center gap-2">
                    <UIcon name="i-lucide-lightbulb" class="w-4 h-4 text-purple-600 dark:text-purple-400" />
                    Saran Pencarian ({{ searchSuggestions.length }} hasil)
                  </h4>
                  <div class="space-y-2 max-h-60 overflow-y-auto">
                    <button
                      v-for="(suggestion, index) in searchSuggestions.slice(0, 12)"
                      :key="index"
                      @click="searchModel = suggestion; performSearch()"
                      class="w-full text-left px-3 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-purple-50 dark:hover:bg-purple-900/30 rounded-lg transition-colors duration-200 hover:text-purple-700 dark:hover:text-purple-300"
                    >
                      {{ suggestion }}
                    </button>
                  </div>
                </div>
                
                <!-- Popular Searches -->
                <div class="p-4 border-t border-gray-200/50 dark:border-gray-700/50">
                  <h4 class="text-sm font-bold text-gray-800 dark:text-gray-200 mb-3 flex items-center gap-2">
                    <UIcon name="i-lucide-trending-up" class="w-4 h-4 text-emerald-600 dark:text-emerald-400" />
                    Pencarian Populer ({{ popularSearches.length }} pilihan)
                  </h4>
                  <div class="flex flex-wrap gap-2 max-h-40 overflow-y-auto">
                    <button
                      v-for="(term, index) in popularSearches"
                      :key="index"
                      @click="searchModel = term; performSearch()"
                      class="px-3 py-1 text-xs font-semibold bg-gradient-to-r from-blue-100 to-purple-100 dark:from-blue-900/30 dark:to-purple-900/30 text-blue-800 dark:text-blue-200 rounded-full hover:from-blue-200 hover:to-purple-200 dark:hover:from-blue-800/40 dark:hover:to-purple-800/40 transition-all duration-200 hover:text-blue-900 dark:hover:text-blue-100"
                    >
                      {{ term }}
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          </div>

          <!-- Super Cool View Options and Pagination Controls -->
          <div class="mt-10 w-full">
            <!-- Enhanced View Options -->
            <div class="flex justify-center mb-8">
              <div class="bg-gradient-to-r from-white/90 via-blue-50/90 to-purple-50/90 dark:from-gray-800/90 dark:via-blue-900/90 dark:to-purple-900/90 backdrop-blur-xl rounded-3xl p-6 shadow-2xl border border-white/20 dark:border-gray-700/50">
                <div class="flex items-center gap-3 mb-4">
                  <div class="w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center">
                    <UIcon name="i-lucide-layout-grid" class="w-5 h-5 text-white" />
                  </div>
                  <span class="text-lg font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent">Tampilkan Artikel:</span>
                </div>
                
                <!-- View Options Grid -->
                <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-3 justify-center">
                  <button
                    v-for="option in viewOptions"
                    :key="option"
                    @click="changeViewLimit(option)"
                    class="px-4 py-3 rounded-2xl text-sm font-bold transition-all duration-500 transform hover:scale-110 hover:-translate-y-1 relative overflow-hidden group"
                    :class="viewLimit === option 
                      ? 'bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 text-white shadow-2xl hover:shadow-purple-500/25' 
                      : 'bg-white/80 dark:bg-gray-700/80 text-gray-700 dark:text-gray-300 hover:bg-gradient-to-r hover:from-blue-100 hover:to-purple-100 dark:hover:from-blue-800/40 dark:hover:to-purple-800/40 border-2 border-gray-200/50 dark:border-gray-600/50 hover:border-blue-300/50 dark:hover:border-blue-500/50'"
                  >
                    <!-- Shimmer effect for active button -->
                    <div v-if="viewLimit === option" class="absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000 ease-out"></div>
                    <span class="relative z-10">{{ viewLabels[option as keyof typeof viewLabels] }}</span>
                  </button>
                </div>
                
                <!-- Current Status -->
                <div class="text-center mt-4">
                  <div class="inline-flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-emerald-100 to-teal-100 dark:from-emerald-900/30 dark:to-teal-900/30 rounded-xl border border-emerald-200/50 dark:border-emerald-700/50">
                    <UIcon name="i-lucide-database" class="w-4 h-4 text-emerald-600 dark:text-emerald-400" />
                    <span class="text-sm font-bold text-emerald-900 dark:text-emerald-100">
                      Total: {{ grandTotalDisplay }} artikel tersedia
                    </span>
                  </div>
                  <div class="mt-2">
                    <div class="inline-flex items-center gap-2 px-3 py-1 bg-gradient-to-r from-blue-100 to-purple-100 dark:from-blue-900/30 dark:to-purple-900/30 rounded-lg border border-blue-200/50 dark:border-blue-700/50">
                      <UIcon name="i-lucide-search" class="w-3 h-3 text-blue-600 dark:text-blue-400" />
                      <span class="text-xs font-medium text-blue-800 dark:text-blue-200">
                        Database lengkap tersedia untuk pencarian
                      </span>
                    </div>
                  </div>
                </div>
                
                <!-- Quick Actions -->
                <div class="text-center mt-3">
                  <div class="flex gap-2 justify-center">
                    <button
                      @click="changeViewLimit(24)"
                      class="px-3 py-1 text-xs font-semibold bg-gradient-to-r from-purple-100 to-violet-100 dark:from-purple-900/30 dark:to-violet-900/30 text-purple-800 dark:text-purple-200 rounded-full hover:from-purple-200 hover:to-violet-200 dark:hover:from-purple-800/40 dark:hover:to-violet-800/40 transition-all duration-200"
                    >
                      ðŸ” 24 ke bawah
                    </button>
                    <button
                      @click="changeViewLimit(0)"
                      class="px-3 py-1 text-xs font-semibold bg-gradient-to-r from-green-100 to-emerald-100 dark:from-green-900/30 dark:to-emerald-900/30 text-green-800 dark:text-green-200 rounded-full hover:from-green-200 hover:to-emerald-200 dark:hover:from-green-800/40 dark:hover:to-emerald-800/40 transition-all duration-200"
                    >
                      ðŸŒŸ Lihat Semua
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Pagination Controls (only show when not in showAll mode and has multiple pages) -->
            <div v-if="!isShowAllMode && blogs?.meta && blogs.meta.last_page > 1">
                <!-- Mobile Pagination: Single Row with Scrollable Numbers -->
                <div class="sm:hidden w-full px-2">
              <nav class="flex items-center gap-2" role="navigation" aria-label="Navigasi halaman" aria-live="polite">
                <!-- Prev -->
                <button
                @click="goToPreviousPage"
                :disabled="blogs.meta.current_page <= 1"
                class="pagination-btn w-9 h-9 shrink-0 rounded-xl bg-white dark:bg-gray-800 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center shadow-md border border-blue-100 dark:border-blue-900/30"
                aria-label="Halaman sebelumnya"
              >
                <UIcon name="i-lucide-chevron-left" class="text-blue-500" />
              </button>

              <!-- Numbers -->
              <div class="flex-1 -mx-2 px-2 overflow-x-auto overflow-y-visible no-scrollbar">
                <div class="flex flex-nowrap items-center justify-center gap-1 w-max mx-auto">
                  <template v-for="(it, idx) in mobilePages" :key="'m-'+idx+'-'+it">
                    <button
                      v-if="typeof it === 'number'"
                      @click="changePage(it)"
                      class="pagination-btn w-8 h-8 px-2 rounded-lg flex items-center justify-center text-xs transition-all duration-300 shadow-md shrink-0"
                      :class="it === blogs.meta.current_page
                        ? 'bg-gradient-to-br from-blue-500 to-blue-600 text-white scale-105'
                        : 'bg-white dark:bg-gray-800 hover:bg-blue-50 dark:hover:bg-blue-900/20 text-gray-800 dark:text-gray-200 border border-blue-100 dark:border-blue-900/30 font-bold'"
                      :aria-current="it === blogs.meta.current_page ? 'page' : undefined"
                      :aria-label="'Halaman ' + it"
                    >
                      {{ it }}
                    </button>
                    <span
                      v-else
                      class="w-8 h-8 px-2 rounded-lg flex items-center justify-center text-xs text-gray-400 dark:text-gray-500 select-none shrink-0"
                      aria-hidden="true"
                      role="separator"
                    >
                      {{ it }}
                    </span>
                  </template>
                </div>
              </div>

              <!-- Next -->
              <button
                @click="goToNextPage"
                :disabled="blogs.meta.current_page >= blogs.meta.last_page"
                class="pagination-btn w-9 h-9 shrink-0 rounded-xl bg-white dark:bg-gray-800 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center shadow-md border border-blue-100 dark:border-blue-900/30"
                aria-label="Halaman selanjutnya"
              >
                <UIcon name="i-lucide-chevron-right" class="text-blue-500" />
              </button>
            </nav>
          </div>

          <!-- Desktop/Tablet Full Pagination -->
          <div class="hidden sm:flex flex-wrap items-center justify-center gap-3">
            <!-- Previous Button -->
            <button
              @click="goToPreviousPage"
              :disabled="blogs.meta.current_page <= 1"
              class="pagination-btn px-5 py-2.5 rounded-xl bg-white dark:bg-gray-800 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center shadow-md border border-blue-100 dark:border-blue-900/30"
              :class="{ 'opacity-50 cursor-not-allowed': blogs.meta.current_page <= 1 }"
          >
              <UIcon name="i-lucide-chevron-left" class="mr-2 text-blue-500" />
              <span class="font-bold text-gray-800 dark:text-gray-200">Sebelumnya</span>
            </button>

            <!-- Page Numbers with first 2, current context, and last 2 (desktop) -->
            <nav class="flex flex-wrap justify-center gap-2" role="navigation" aria-label="Navigasi halaman">
              <template v-for="(it, idx) in desktopPages" :key="'d-'+idx+'-'+it">
                <span
                  v-if="typeof it !== 'number'"
                  class="w-11 h-11 rounded-xl flex items-center justify-center text-gray-400 dark:text-gray-500 select-none"
                  aria-hidden="true"
                  role="separator"
                >{{ it }}</span>
                <button
                  v-else
                  @click="changePage(Number(it))"
                  class="pagination-btn w-11 h-11 rounded-xl flex items-center justify-center transition-all duration-300 shadow-md font-medium focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500"
                  :class="Number(it) === blogs.meta.current_page
                    ? 'bg-gradient-to-br from-blue-500 to-blue-600 text-white scale-110 transform'
                    : 'bg-white dark:bg-gray-800 hover:bg-blue-50 dark:hover:bg-blue-900/20 text-gray-800 dark:text-gray-200 border border-blue-100 dark:border-blue-900/30 font-bold'"
                  :aria-current="Number(it) === blogs.meta.current_page ? 'page' : undefined"
                  :aria-label="'Halaman ' + it"
                >
                  {{ it }}
                </button>
              </template>
            </nav>

            <!-- Next Button -->
            <button
              @click="goToNextPage"
              :disabled="blogs.meta.current_page >= blogs.meta.last_page"
              class="pagination-btn px-5 py-2.5 rounded-xl bg-white dark:bg-gray-800 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center shadow-md border border-blue-100 dark:border-blue-900/30"
              :class="{ 'opacity-50 cursor-not-allowed': blogs.meta.current_page >= blogs.meta.last_page }"
            >
              <span class="font-bold text-gray-800 dark:text-gray-200">Berikutnya</span>
              <UIcon name="i-lucide-chevron-right" class="ml-2 text-blue-500" />
            </button>
          </div>
                <div class="mt-6 flex justify-center" aria-live="polite">
                  <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/30 dark:to-purple-900/30 border-2 border-blue-200 dark:border-blue-700 shadow-lg text-sm font-bold text-blue-900 dark:text-blue-100">
                    <UIcon name="i-lucide-list-filter" class="text-blue-600 dark:text-blue-400 w-5 h-5" />
                    <span>
                      Menampilkan {{ startIndexDisplay }} ke {{ endIndexDisplay }} dari total {{ grandTotalDisplay }} blog
                    </span>
                  </div>
              </div>
            </div>
          </div>
        </div>
      </template>
    </div>
  </UPageSection>

  <LazyStarsBg />
</template>

<style scoped>
/* Blog grid styles are now in blog-responsive-improvements.css */

/* Super Cool Animations */
@keyframes grid-move {
  0% { transform: translate(0, 0); }
  100% { transform: translate(20px, 20px); }
}

@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-10px); }
}

@keyframes glow {
  0%, 100% { box-shadow: 0 0 20px rgba(59, 130, 246, 0.3); }
  50% { box-shadow: 0 0 40px rgba(147, 51, 234, 0.5); }
}

/* Enhanced blog card animations */
.blog-card {
  animation: float 6s ease-in-out infinite;
}

.blog-card:nth-child(2n) {
  animation-delay: 1s;
}

.blog-card:nth-child(3n) {
  animation-delay: 2s;
}

.blog-card:nth-child(4n) {
  animation-delay: 3s;
}

/* Optional variant: force 4 cols on small screens (<=480px) with compact text/padding */
@media (max-width: 480px) {
  .news-grid--force-4-mobile {
    grid-template-columns: repeat(4, 1fr) !important;
  }
  .news-grid--force-4-mobile .news-card-body {
    padding: 8px !important;
  }
  .news-grid--force-4-mobile .news-card-title {
    font-size: 12px;
    line-height: 1.2;
    -webkit-line-clamp: 1;
    line-clamp: 1;
    max-height: 1.2em;
  }
  .news-grid--force-4-mobile .news-card-meta {
    font-size: 10px;
  }
}

/* Blog card styles are now in blog-responsive-improvements.css */


/* Hide scrollbar utility (works on most browsers) */
.no-scrollbar::-webkit-scrollbar {
  display: none;
}
.no-scrollbar {
  -ms-overflow-style: none; /* IE and Edge */
  scrollbar-width: none; /* Firefox */
}

/* Holo lift effect for pagination buttons */
.pagination-btn {
  position: relative;
  transform: translateY(0) scale(1);
  transition: transform 180ms cubic-bezier(.2,.7,.2,1), box-shadow 220ms ease, background-color 220ms ease, border-color 220ms ease;
  will-change: transform, box-shadow;
}

.pagination-btn:hover:not(:disabled),
.pagination-btn:focus-visible:not(:disabled) {
  transform: translateY(-2px) scale(1.02);
  box-shadow:
    0 8px 20px rgba(59, 130, 246, 0.25),
    0 0 0 2px rgba(59, 130, 246, 0.15),
    0 0 16px rgba(167, 139, 250, 0.25),
    0 2px 0 rgba(255, 255, 255, 0.5) inset;
}

.pagination-btn:active:not(:disabled) {
  transform: translateY(-1px) scale(0.99);
  box-shadow:
    0 6px 16px rgba(59, 130, 246, 0.22),
    0 0 0 2px rgba(59, 130, 246, 0.12),
    0 0 12px rgba(34, 211, 238, 0.22),
    0 1px 0 rgba(255, 255, 255, 0.45) inset;
}

/* Subtle holo aura */
.pagination-btn::before {
  content: "";
  position: absolute;
  inset: -2px;
  border-radius: inherit;
  background: conic-gradient(from 180deg at 50% 50%, #60a5fa, #a78bfa, #22d3ee, #60a5fa);
  opacity: 0;
  filter: blur(12px);
  transition: opacity 200ms ease, filter 200ms ease;
  pointer-events: none;
  z-index: -1;
}

.pagination-btn:hover::before,
.pagination-btn:focus-visible::before {
  opacity: 0.6;
  filter: blur(14px);
}

/* Reduce glow in dark mode a bit */
.dark .pagination-btn:hover:not(:disabled),
.dark .pagination-btn:focus-visible:not(:disabled) {
  box-shadow:
    0 10px 24px rgba(59, 130, 246, 0.18),
    0 0 0 2px rgba(59, 130, 246, 0.18),
    0 0 16px rgba(167, 139, 250, 0.22),
    0 2px 0 rgba(255, 255, 255, 0.06) inset;
}

/* Lift + holo glow for news cards */
.news-card {
  position: relative;
  backface-visibility: hidden;
  transform: translateY(0) scale(1);
  transition: transform 220ms cubic-bezier(.2,.7,.2,1), box-shadow 260ms ease, border-color 200ms ease, background-color 200ms ease;
  will-change: transform, box-shadow;
}

.news-card:hover,
.news-card:focus-visible {
  transform: translateY(-4px) scale(1.01);
  box-shadow:
    0 18px 40px rgba(59, 130, 246, 0.18),
    0 8px 24px rgba(2, 6, 23, 0.06);
}

.news-card:active {
  transform: translateY(-2px) scale(0.995);
}

/* Subtle holo aura for news cards */
.news-card::before {
  content: "";
  position: absolute;
  inset: -3px;
  border-radius: inherit;
  background: conic-gradient(from 180deg at 50% 50%, #60a5fa, #a78bfa, #22d3ee, #60a5fa);
  opacity: 0;
  filter: blur(20px);
  transition: opacity 220ms ease, filter 220ms ease;
  pointer-events: none;
  z-index: -1;
}

.news-card:hover::before,
.news-card:focus-visible::before {
  opacity: 0.55;
  filter: blur(22px);
}

/* Dark mode tuning for card shadows */
.dark .news-card:hover,
.dark .news-card:focus-visible {
  box-shadow:
    0 20px 44px rgba(30, 64, 175, 0.18),
    0 10px 28px rgba(2, 6, 23, 0.12);
}

@media (prefers-reduced-motion: reduce) {
  .news-card {
    transition: box-shadow 260ms ease;
  }
  .news-card:hover,
  .news-card:focus-visible,
  .news-card:active {
    transform: none;
  }
}

/* Enhanced text styling for better readability */
.text-shadow-sm {
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

.blog-card-title {
  font-weight: 700;
  letter-spacing: -0.025em;
}

.blog-card-meta {
  font-weight: 500;
}

/* Enhanced blog card styling */
.blog-card {
  position: relative;
  backface-visibility: hidden;
  transform: translateY(0) scale(1);
  transition: transform 300ms cubic-bezier(.2,.7,.2,1), box-shadow 350ms ease, border-color 250ms ease, background-color 250ms ease;
  will-change: transform, box-shadow;
}

.blog-card:hover,
.blog-card:focus-visible {
  transform: translateY(-6px) scale(1.02);
  box-shadow:
    0 25px 50px rgba(59, 130, 246, 0.15),
    0 12px 30px rgba(2, 6, 23, 0.08),
    0 0 0 1px rgba(59, 130, 246, 0.1);
}

.blog-card:active {
  transform: translateY(-3px) scale(1.01);
}

/* Enhanced holo aura for blog cards */
.blog-card::before {
  content: "";
  position: absolute;
  inset: -4px;
  border-radius: inherit;
  background: conic-gradient(from 180deg at 50% 50%, #60a5fa, #a78bfa, #22d3ee, #60a5fa, #f472b6);
  opacity: 0;
  filter: blur(25px);
  transition: opacity 300ms ease, filter 300ms ease;
  pointer-events: none;
  z-index: -1;
}

.blog-card:hover::before,
.blog-card:focus-visible::before {
  opacity: 0.4;
  filter: blur(28px);
}

/* Dark mode tuning for blog card shadows */
.dark .blog-card:hover,
.dark .blog-card:focus-visible {
  box-shadow:
    0 28px 56px rgba(30, 64, 175, 0.12),
    0 14px 35px rgba(2, 6, 23, 0.15),
    0 0 0 1px rgba(59, 130, 246, 0.15);
}

/* Enhanced text gradient for titles */
.text-gradient {
  background-size: 200% 200%;
  animation: gradient-shift 3s ease infinite;
}

@keyframes gradient-shift {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

/* Enhanced shadow utilities */
.shadow-3xl {
  box-shadow: 0 35px 60px -12px rgba(0, 0, 0, 0.25);
}

/* Improved loading states */
.loading-placeholder {
  background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
  background-size: 200% 100%;
  animation: loading 1.5s infinite;
}

@keyframes loading {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}
</style>


